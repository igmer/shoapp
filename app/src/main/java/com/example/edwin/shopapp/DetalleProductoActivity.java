package com.example.edwin.shopapp;import android.content.Context;import android.content.Intent;import android.content.SharedPreferences;import android.os.AsyncTask;import android.support.v7.app.AppCompatActivity;import android.os.Bundle;import android.util.Log;import android.view.View;import android.widget.Button;import android.widget.ImageView;import android.widget.Toast;import com.squareup.picasso.Picasso;import java.sql.Connection;import java.sql.ResultSet;import java.sql.Statement;import java.text.SimpleDateFormat;import java.util.ArrayList;import java.util.Calendar;import java.util.Date;public class DetalleProductoActivity extends AppCompatActivity {    String codigo,url;    ImageView imDetalle;    Button btnAdd;    static ArrayList pedido=new ArrayList();    private SharedPreferences pref;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_detalle_producto);        pref = getSharedPreferences("Preferences", Context.MODE_PRIVATE);        Bundle bundle = getIntent().getExtras();        codigo = bundle.getString("codigo");        url = bundle.getString("url"); //este es el nombre de la imagen        imDetalle =(ImageView)findViewById(R.id.imDetalleProducto);        Picasso.get().load("http://www.geoshop.somee.com/UpImg/"+url).into(imDetalle);        btnAdd = (Button)findViewById(R.id.btnConfirmar);        btnAdd.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {               //Toast.makeText(getApplicationContext(),codigo,Toast.LENGTH_LONG).show();                agregarProducto add = new agregarProducto();                add.execute("");            }        });    }    class agregarProducto extends AsyncTask<String,String,Integer>{        @Override        protected Integer doInBackground(String... strings) {            Connection connect; connect = ConexionSQL.ConnectionHelper();            String mensaje_error="";            String usuario  = pref.getString("usuarioBD","");//obtnemos el usuario            Date currentTime = Calendar.getInstance().getTime();            SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");            String fecha = dateFormat.format(currentTime);            Integer ingresado=0;            try {                Statement st = connect.createStatement();                String comando="INSERT INTO pedidos(idEstado,fechaIngreso,idCliente,latitud,longitud)values('SOL','"+fecha+"','"+usuario+"','13.700059'," +                        "'-89.200195')";                st.execute(comando);                connect.close();                ingresado = 1;            } catch (Exception e) {                Toast.makeText(getApplicationContext(),"Error: "+e.getMessage(),Toast.LENGTH_LONG).show();                ingresado=0;            }            return ingresado;        }        @Override        protected void onPostExecute(Integer respuesta) {           //super.onPostExecute(integer);            if (respuesta==1){                Toast.makeText(getApplicationContext(),"Producto agregado a su pedido",Toast.LENGTH_LONG).show();                Intent i = new Intent(getApplicationContext(),MenusTabs.class);                startActivity(i);            }else{                Toast.makeText(getApplicationContext(),"Hubo un error al agregar el producto",Toast.LENGTH_LONG).show();            }        }    }}